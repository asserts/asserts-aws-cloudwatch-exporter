delay: 60
scrapeInterval: 300
discoverECSTasks: true
ecsTaskScrapeConfigs:
  - containerDefinitionName: aws-cloudwatch-exporter
    metricPath: /aws-exporter/actuator/prometheus
regions:
  - us-west-2
namespaces:
  - name: AWS/Lambda
    dimensionFilters:
      FunctionName: .+
    metrics:
      - name: Invocations
        stats:
          - Sum
      - name: Errors
        stats:
          - Sum
      - name: Throttles
        stats:
          - Sum
      - name: Duration
        stats:
          - p99
          - Average
          - Maximum
      - name: ConcurrentExecutions
        stats:
          - Average
          - Maximum
    logs:
      - lambdaFunctionName: (Function.+)|(OrderProcessor)
        logFilterPattern: "About to put message in SQS Queue"
        regexPattern: ".*put message in SQS Queue https://sqs.us-west-2.amazonaws.com/342994379019/(.+)"
        labels:
          "destination_type": "SQSQueue"
          "destination_name": "$1"
  - name: AWS/SQS
    metrics:
      - name: NumberOfMessagesSent
        stats:
          - Sum
  - name: LambdaInsights
    dimensionFilters:
      function_name: .+
    metrics:
      - name: memory_utilization
        stats:
          - Average
          - Maximum
      - name: used_memory_max
        stats:
          - Average
          - Maximum
      - name: cpu_total_time
        stats:
          - Sum
      - name: tx_bytes
        stats:
          - Sum
      - name: rx_bytes
        stats:
          - Sum
discoverResourceTypes:
  - AWS::EC2::Instance
  - AWS::ElasticLoadBalancingV2::LoadBalancer
  - AWS::RDS::DBInstance
  - AWS::RDS::DBCluster
  - AWS::S3::Bucket
  - AWS::ElasticLoadBalancing::LoadBalancer
  - AWS::AutoScaling::AutoScalingGroup
  - AWS::DynamoDB::Table
  - AWS::Lambda::Function
  - AWS::ApiGateway::RestApi
  - AWS::ApiGatewayV2::Api
  - AWS::SQS::Queue
  - AWS::SNS::Topic
  - AWS::ECS::Cluster
  - AWS::ECS::Service
  - AWS::Kinesis::Stream
tagExportConfig:
  excludePattern: .*cloudformation.*